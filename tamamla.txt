===============================================================================
         HaToKuSe DİSTRİBÜTED DİSK REGİSTER PROJESİ GEREKSİNİM ANALİZİ
===============================================================================

# TAMAMLANAN GEREKSİNİMLER ✅
===============================================================================

[x] 1. gRPC kullanımı
    - gRPC bağımlılıkları pom.xml'de tanımlı
    - family.proto dosyası ile servis ve mesaj tanımları yapılmış
    - FamilyReplicationServiceGrpc sınıfı otomatik üretilmiş

[x] 2. HaToKuSe Text Protokolü (İstemci-Lider arası)
    - SET <message_id> <message> komutu destekleniyor (LeaderTextClientHandler)
    - GET <message_id> komutu destekleniyor (LeaderTextClientHandler)
    - OK/ERROR yanıtları döndürülüyor

[x] 3. Aile İçi Protobuf Haberleşme
    - İstemciden text tabanlı mesaj alınıyor
    - Lider-üye arası gRPC/protobuf ile haberleşme yapılıyor
    - StoredMessage, ReplicateMessageRequest/Response tanımlı

[x] 4. tolerance.conf Dosyasından Okuma
    - ToleranceConfigLoader: tolerance.conf dosyasından hata toleransı değeri okunuyor
    - Dosya yoksa varsayılan değer (2) kullanılıyor

[x] 5. Mesajların Diske Kaydedilmesi
    - DiskStorage sınıfı: mesajları <baseDir>/<messageId>.txt olarak kaydediyor
    - Lider kendi diskine kaydediyor (data/leader/)
    - Üyeler kendi disklerine kaydediyor (data/member-<port>/)

[x] 6. Replikasyon (Hata Toleransı Kadar Üyeye Gönderim)
    - LeaderState.handleSet(): replicationFactor kadar üyeye mesaj gönderiyor
    - Round-robin ile dengeli dağıtım yapılıyor

[x] 7. Mesaj-Üye Eşlemesi (Lider Tarafında)
    - LeaderState.messageToMembers: hangi mesajın hangi üyelerde tutulduğu kaydediliyor

[x] 8. GET İsteğinde Crash Toleransı
    - LeaderState.handleGet(): mesajı tutan üyeler rastgele sırayla deneniyor
    - Bir üye crash olmuşsa diğerinden mesaj alınabiliyor

[x] 9. Periyodik İstatistik Bastırma (Lider)
    - LeaderNode.startStatsPrinter(): 10 saniyede bir toplam mesaj sayısı ve
      üye başına mesaj sayısı bastırılıyor

[x] 10. gRPC RPC Tanımları
    - ReplicateMessage: SET için mesaj çoğaltma
    - FetchMessage: GET için mesaj okuma
    - RegisterNode: dinamik üye kaydı (tanımlı)

[x] 11. Lider/Üye Modunda Çalıştırma
    - NodeMain: "leader" veya "member <port>" parametresiyle başlatılabiliyor

[x] 12. members.conf Dosyasından Üye Listesi Okuma
    - MembersConfigLoader: statik üye listesi dosyadan okunuyor

[x] 13. Üyelerin Periyodik Mesaj Sayısı Bastırması ✅ 
    - MemberNode.startStatsPrinter(): 10 saniyede bir mesaj sayısı bastırılıyor

[x] 14. Dinamik Üye Kayıt Sistemi ✅ 
    - LeaderState.addDynamicMember(): runtime'da üye ekleme
    - LeaderReplicationServiceImpl: RegisterNode RPC işleyicisi
    - LeaderNode: port 6000'de gRPC sunucusu dinliyor
    - MemberNode: başlangıçta lidere RegisterNode RPC ile kendini kaydediyor

[x] 15. Dinamik Üye Çıkışı ✅ 
    - LeaderState.removeDynamicMember(): runtime'da üye çıkarma

[x] 16. tolerance.conf Dosyası ✅ 
    - tolerance.conf dosyası oluşturuldu (değer: 2)

[x] 17. members.conf Dosyası ✅ 
    - members.conf dosyası oluşturuldu (5 üye tanımlı)

[x] 18. Client (İstemci) Uygulaması ✅ 
    - HaToKuSeClient.java: SET/GET komutları gönderen TCP istemci

[x] 19. DİSKE FARKLI KAYIT BİÇİMLERİ ✅ YENİ TAMAMLANDI
    - DiskStorage.WriteMode.BUFFERED: BufferedOutputStream ile tamponlanmış I/O
    - DiskStorage.WriteMode.UNBUFFERED: Direct FileOutputStream, fsync ile
    - DiskStorage.WriteMode.ZERO_COPY: FileChannel ile zero-copy prensibi
    - DiskStorage.WriteMode.MEMORY_MAPPED: MappedByteBuffer ile bellek eşlemeli I/O
    - Komut satırından seçilebilir: java -jar app.jar leader zerocopy

[x] 20. ARKA ARKAYA İSTEK YAPAN CLIENT ✅ YENİ TAMAMLANDI
    - HaToKuSeClient auto modu: Arka arkaya SET istekleri gönderir
    - HaToKuSeClient get-test modu: Arka arkaya GET istekleri gönderir
    - Kullanım: java -jar app.jar client localhost 5000 auto 1000
    - İlerleme göstergesi ve performans istatistikleri


===============================================================================
# EKSİK / TAMAMLANMASI GEREKEN GEREKSİNİMLER ❌
===============================================================================

[ ] 1. Dengeli Dağıtım Doğrulaması
    DURUM: Round-robin ile dağıtım var ama test edilmemiş
    GEREKLİ: tolerance=2 için 5 üye ile 1000 mesaj -> 500/500 dengeli dağılım
    ÇÖZÜM: Test senaryoları yazılmalı

[ ] 2. Yeni Üyenin Mevcut Yükü Dengelemesi (İsteğe Bağlı)
    NOT: Ödevde "geçmişe dönük yük dağılımı yapmasına gerek yok" denmiş
    MEVCUT DURUM: Zaten yapılmıyor, DOĞRU

===============================================================================
# ÖNCELİKLİ YAPILACAKLAR LİSTESİ
===============================================================================

TAMAMLANDI:
1. [x] tolerance.conf dosyası oluştur (içeriği: 2)
2. [x] members.conf dosyası oluştur 
       Örnek içerik:
       n1 localhost 7001
       n2 localhost 7002
       n3 localhost 7003
       n4 localhost 7004
       n5 localhost 7005

3. [x] MemberNode'a periyodik mesaj sayısı bastırma ekle
4. [x] Dinamik üye kaydı için LeaderState'e addDynamicMember() metodu ekle
5. [x] MemberNode başlarken lidere kendini kaydetsin
6. [x] Basit bir Client uygulaması yaz (HaToKuSeClient.java)
7. [x] DiskStorage'a farklı I/O modları ekle (buffered, unbuffered, zero-copy, memory-mapped)
8. [x] Arka arkaya istek yapan otomatik test modu ekle

ORTA ÖNCELİK:
9. [ ] Test senaryoları oluştur (TestScenario1, TestScenario2)

DÜŞÜK ÖNCELİK:
10. [ ] Heartbeat mekanizması ile ölü üye tespiti (opsiyonel)

===============================================================================
# TEST SENARYOLARI DURUMU
===============================================================================

Test 1 (tolerance=2, 5 terminal):
- [x] Birden fazla üye başlatılabilir
- [x] Lider mesajları hata toleransı kadar üyeye gönderiyor
- [ ] 1000 mesaj için 500/500 dengeli dağıtım TEST EDİLMEDİ
- [x] Lider mesaj-üye eşlemesini tutuyor
- [x] Bir üye crash olursa diğerinden mesaj alınabilir (mantık mevcut)

Test 2 (tolerance=3, 7 terminal):
- [ ] 9000 mesaj için 4500/4500 dengeli dağıtım TEST EDİLMEDİ
- [x] Crash toleransı mantığı mevcut

===============================================================================
ÖZET: Temel yapı %100 oranında tamamlandı! ✅

Tamamlanan son eklemeler:
- DiskStorage'a 4 farklı I/O modu eklendi:
  * BUFFERED: Tamponlanmış I/O (varsayılan)
  * UNBUFFERED: Tamponsuz doğrudan I/O
  * ZERO_COPY: Zero-copy FileChannel I/O
  * MEMORY_MAPPED: Memory-mapped bellek eşlemeli I/O
- HaToKuSeClient'a otomatik test modları eklendi:
  * auto: Arka arkaya SET istekleri
  * get-test: Arka arkaya GET istekleri
- NodeMain komut satırından I/O modu seçimi destekliyor

Kalan tek eksik:
- Dengeli dağıtım test senaryoları (opsiyonel)
===============================================================================

===============================================================================
# KULLANIM KILAVUZU
===============================================================================

1. Lider başlatma (farklı I/O modları ile):
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar leader buffered
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar leader unbuffered
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar leader zerocopy
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar leader memorymapped

2. Üye başlatma (farklı I/O modları ile):
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar member 7001 buffered
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar member 7002 zerocopy

3. Client kullanımı:
   # İnteraktif mod
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar client localhost 5000
   
   # Otomatik SET testi (1000 mesaj)
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar client localhost 5000 auto 1000
   
   # Otomatik GET testi (100 mesaj)
   java -jar target/distributed-disk-register-0.0.1-SNAPSHOT.jar client localhost 5000 get-test 100

===============================================================================
